<script>
    function initMap() {
        // get location
        let options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        };
        // Mostrar o as rotas dos transportes públicos e o tráfego
        const transitButton = document.createElement('button');
        const trafficButton = document.createElement('button');
        navigator.geolocation.getCurrentPosition(pos => {
            const posicao = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
            const map = new google.maps.Map(document.getElementById('map'), {
                zoom: 15,
                center: posicao,
            });
            
            transitButton.textContent = "Linhas de transporte"; // Metrô e trem
            transitButton.classList.add("custom-map-control-button");
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(transitButton);

            trafficButton.textContent = "Tráfego";
            trafficButton.classList.add("custom-map-control-button");
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(trafficButton);

            const transitLayer = new google.maps.TransitLayer();
            const trafficLayer = new google.maps.TrafficLayer();

            transitButton.addEventListener('click', _ => {
                // toggle
                if(transitLayer.getMap()) {
                    transitLayer.setMap(null);
                } else {
                    transitLayer.setMap(map);
                }
                
            });

            trafficButton.addEventListener('click', _ => {
                // toggle
                if(trafficLayer.getMap()) {
                    trafficLayer.setMap(null);
                } else {
                    trafficLayer.setMap(map);
                }
            });

            // Marcador "você está aqui"
            const marker = new google.maps.Marker({
                position: posicao,
                map,
                title: 'Você está aqui!'
            });
        }, 
        err => alert(err + ' Please enable your GPS position feature.'), 
        options);
        
    }
</script>